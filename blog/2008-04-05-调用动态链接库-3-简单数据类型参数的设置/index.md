---
title: "调用动态链接库 3 - 简单数据类型参数的设置"
date: "2008-04-05"
tags: 
  - "我和labview"
---

    复杂问题先从简单地说起，在DLL和LabVIEW之间传递参数，最常用的三种数据类型是：数值类型、字符串、数值型数组。这几种类型的参数配置起来还是比较简单的。

**1\. 数值类型**  
    LabVIEW 多种不同精度的数值类型与C语言中的数值类型的匹配是相当直观的，比如 4-byte Single 对应 C 语言中的 float。LabVIEW 自带的例子“LabVIEW 8.5\\examples\\dll\\data passing\\Call Native Code.llb”中详细的列出了简单数据类型在 LabVIEW 与 C 之间的对应关系。  
    C 语言中经常把指针，或者数据的地址在函数间传递。在32位操作系统中，可以使用int32数值来表示指针。因此，当需要在LabVIEW中传递指针数据时，可以使用I32或U32数值类型来表示这个地址类型的数据。但是，64位的程序中，数据的地址只能使用I64或U64来表示。这样，如果一个调用了DLL函数的VI，并且函数参数中有地址型数据，使用固定数据类型的数值来表示地址，就要准备两份代码。解决方法就是使用 LabVIEW 中的新的数据类型 Pointer-sized Integer。这个数据类型的长度在不同的平台上会自动使用32位或64位长度。  
    如果在C语言函数参数声明中有const关键字，可以选中Constant选项。
```
<table style="border-collapse:collapse;" border="0"><colgroup><col style="width:84px;"> <col style="width:214px;"> <col style="width:230px;"></colgroup><tbody valign="top"><tr style="height:22px;"><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-left:silver .5pt solid;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:宋体;">输入</span><span style="font-family:times new roman;">/</span><span style="font-family:宋体;">输出</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:宋体;">输入</span></p></td><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:宋体;">输出或兼作输入输出</span></p></td></tr><tr style="height:22px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">C</span><span style="font-family:宋体;">语言声明</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;">float red;</p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;">float* red;</p></td></tr><tr style="height:21px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">LabVIEW<br></span><span style="font-family:宋体;">中的配置</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://by1.storage.msn.com/y1pH5Es9Ox64kaizaxO3J63rPpUjiPxjo3bilYkPzc1GDaBPxyaniqyouXHckJYk0wIgUqXDvRv78ZeZbB-a3wdcO03gc0BHIRz?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THoc_0AHueZlgd3SVIP2cyvdcajv66iWUfAbyAeemS2lst2nNmR876dfpLw_Q2KIDbuE?PARTNER=WRITER" border="0"></a></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THofTRMTB7DoGNR09muDvJnhZ92FnjUOXCvDIXVQ94Ukdp9Oo0i3wij0ZeMdUSZG6maU?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THocOEphCBLw5DYMkdZUuCixzPYLXJjzFxh4Iwn6rNbBffyNZ6eAsZwQXqxajrVqB1Ys?PARTNER=WRITER" border="0"></a></p></td></tr><tr style="height:28px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">LabVIEW<br></span><span style="font-family:宋体;">的使用</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THodK9p5lIvmhD3tjwe1S6c5D2JOaysS3MNerSkuljqiWOGT_vQdZLpmhEvmjlSImMDI?PARTNER=WRITER"><img src="http://by1.storage.msn.com/y1pH5Es9Ox64kYaxyqpaQ9wQuGZaNgQAQ1COsIFT3ltXxLdcUh0Oxt72rlqPQSyDlE46MEWF-PcjbNfAbyyhtMuaepB4s7fhgUw?PARTNER=WRITER" border="0"></a></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://by1.storage.msn.com/y1pH5Es9Ox64kac4tTS20jKGGnR_M4lgzipRZQbM_AQLIqF3-9xO7i4d-OPdw6DoEzRjEgptRoeMCTy9Ht3y20evIws2MDIZuFm?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THoc57D0q03XPiJ7QnZ3cNyD9PLKVxcsCxAzJ5LIwnXVU3C1jhg8HkHlPwb2Ltutw2cI?PARTNER=WRITER" border="0"></a></p></td></tr></tbody></table>

**2\. 布尔类型**  
    布尔类型在 DLL 函数和 LabVIEW VI 之间传递没有专有的数据类型，是利用数值类型来传递的。输入时先把布尔值转变为数值，在传递给DLL函数；输出时再把数值转为布尔值。

<table style="border-collapse:collapse;" border="0"><colgroup><col style="width:84px;"> <col style="width:214px;"> <col style="width:230px;"></colgroup><tbody valign="top"><tr style="height:22px;"><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-left:silver .5pt solid;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:宋体;">输入</span><span style="font-family:times new roman;">/</span><span style="font-family:宋体;">输出</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:宋体;">输入</span></p></td><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:宋体;">输出或兼作输入输出</span></p></td></tr><tr style="height:22px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">C</span><span style="font-family:宋体;">语言声明</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:times new roman;">bool red;</span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:times new roman;">bool* red;</span></p></td></tr><tr style="height:21px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">LabVIEW<br></span><span style="font-family:宋体;">中的配置</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THocDmwHto586PLKhoXVJmfPT5nhLDBcGWXl2k9cFLZxpV3HLtVIS-08TIeRzYBCHklM?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THodr6fgiy75aepHOG9D57Hg03kIWieqas_ZXWni6GjRsDrUUJ0gzU__5o-LeniKQKis?PARTNER=WRITER" border="0"></a></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THocoJH-P5yBZo5NdHkKyd84mtzUio3RzGXAeJFBC_XlB7TzJqPXZxCZJcXoKLuDvfHY?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THodKBfjrIokJpAcKxU5VtyAL4KThMbCQE1hE5yULerClJrA0FsJ-Twk6tVvju3rebJI?PARTNER=WRITER" border="0"></a></p></td></tr><tr style="height:28px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">LabVIEW<br></span><span style="font-family:宋体;">的使用</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THoctJ7FcjPnalQjChKC_35T4R8U0g0VEuwIaNqzpVtfgJDvqdXRKeMO25quOPohAYCU?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THodHYaaxncDLaFCjmLsWBFJWtjVfpMUlcjmgPQMbra6jebDbDEhsU1yJrR7GT-lfG9k?PARTNER=WRITER" border="0"></a></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THodewzzj-rysSNQPPB4fOIPc3-lH_7Kl6w80ABfDRk2n5mdTUVSXIZsuxWTwtU2xqmk?PARTNER=WRITER"><img src="http://by1.storage.msn.com/y1pH5Es9Ox64kZy4cpQ-XwNaPemrW-TVyjJV4TmuWnlJiK1cRpssVGucbk2DZFbISlvSoRbcaug68ewiNbmO-f0QLksHuqakQQB?PARTNER=WRITER" border="0"></a></p></td></tr></tbody></table>

**3\. 数值型数组**  
    对于数组的传递，LabVIEW 只支持 C 数据类型中的数值型数组。传递数组类型需要注意的的是“Array Format”要选择“Array Data Pointer”。这个设置中还有其他两个选项，像这种带有“Handle”的参数类型都是表示LabVIEW定义的特殊类型的。在第三方的DLL中不会使用到。  
    数组参数作为输出值时，要记得为输出的数组数据开辟空间。开辟数据空间的方法有两种：  
    第一种方法，创建一个长度满足要求的数组，作为初始值传递给参数，输出数的数据就会被放置在输入数组的所在的内存空间内。  
    第二种方法是直接在参数配置面板上进行设置。在 Minimum size 中写入一个固定的数值，LabVIEW 就会按此大小为输出的数组开辟空间。在 Minimum size 中选择函数的其它数值参数，而不是固定数值。这样 LabVIEW 会按照当时被选择的参数的值的大小来开辟空间。

<table style="border-collapse:collapse;" border="0"><colgroup><col style="width:84px;"> <col style="width:214px;"> <col style="width:230px;"></colgroup><tbody valign="top"><tr style="height:22px;"><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-left:silver .5pt solid;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:宋体;">输入</span><span style="font-family:times new roman;">/</span><span style="font-family:宋体;">输出</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:宋体;">输入</span></p></td><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:宋体;">输出或兼作输入输出</span></p></td></tr><tr style="height:22px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">C</span><span style="font-family:宋体;">语言声明</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:times new roman;">int values[];</span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:times new roman;">int values[];</span></p></td></tr><tr style="height:21px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">LabVIEW<br></span><span style="font-family:宋体;">中的配置</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://by1.storage.msn.com/y1pH5Es9Ox64ka1mTIYvvA92RIQKMqy9iRaZXJHMBW6y_eAS0Lxoo8mfp0Ae8n0v6oynweZ8W7dBMwr__zsloupFkGUQwrt76bn?PARTNER=WRITER"><img src="http://by1.storage.msn.com/y1pH5Es9Ox64kYdHsX7kvdyGMeTDBd3N7f8uV-9D37YO-UjgSQZY1ruvlKJbzs00pkQ4NmRwz475YH2-C0BD7Hlkh_sXp1Jd1b8?PARTNER=WRITER" border="0"></a></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://by1.storage.msn.com/y1pH5Es9Ox64kYnLAHfjNgb2B0K31oAwMtQWnkGeo-frRryNCOu3zurtj3kPffWt9FmhF0pJTGToSDM_iaZKhOQUSU0kI54XGmQ?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THofrCKlaxqyxWCSCiYHs-pt_fDGz6SrPyR_z8djyJa6HR8n_RSOb0zr-ysgrvmSlRrs?PARTNER=WRITER" border="0"></a></p></td></tr><tr style="height:47px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">LabVIEW<br></span><span style="font-family:宋体;">的使用</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THoe2j22_6JVPI7a_XXSeyGgkTOvKostTrZXpLh5Q0LT3W1tG07cnrIDKrjGb9WsXNmU?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THod9rqdn4ywJD4c8YlO1_PiGWZBDboR6au9OSwm9jsCKX-kGF80OF_LaQf0nqaNPwXU?PARTNER=WRITER" border="0"></a></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THofvb9stdBpPSFTzZT5n1WF9WIM4FhUIgMvaq9eosqAUN27GAKmpi6-n9vQoYlsaOpk?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THoc_JjryYTx6hzk82iEbtwEjc2gSc1n73Dp4ZuebCllJPd7uxibV920h6ZVtAuL-7rQ?PARTNER=WRITER" border="0"></a></p></td></tr></tbody></table>

**4\. 字符串类型**  
    字符串与使用与数组是非常类似的，实际上在C语言中字符串就是一个I8数组。

<table style="border-collapse:collapse;" border="0"><colgroup><col style="width:84px;"> <col style="width:214px;"> <col style="width:230px;"></colgroup><tbody valign="top"><tr style="height:22px;"><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-left:silver .5pt solid;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:宋体;">输入</span><span style="font-family:times new roman;">/</span><span style="font-family:宋体;">输出</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:宋体;">输入</span></p></td><td style="border-right:silver .5pt solid;border-top:silver .5pt solid;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:宋体;">输出或兼作输入输出</span></p></td></tr><tr style="height:22px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">C</span><span style="font-family:宋体;">语言声明</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:times new roman;">char* name;</span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><span style="font-size:9pt;color:black;font-family:times new roman;">char* name;</span></p></td></tr><tr style="height:21px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">LabVIEW<br></span><span style="font-family:宋体;">中的配置</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THofKeI81gen3zGuj5ipT1di9pDS2sAJElnNO3juZFjW9nOhkD6pmMQSisKdnPCvHl3w?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THod7K5B2xzXCOoajjjRL3oyStl-In55KSCfad5iczQUo-NrRoQT5B1oLs5FplJhCvmw?PARTNER=WRITER" border="0"></a></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THoeQevI4z4UxUILmPRNFVvwFM7xYGvvSejt_JZGDHpTt1th7YZq-InBVcXepzzCA6XI?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THoc4I_MHXOvEuaa-d9SROc2xUAwUIMHbgpfTGxuKNk7fhMxOBaTvGfI7bv4tkmNrP-U?PARTNER=WRITER" border="0"></a></p></td></tr><tr style="height:28px;"><td style="border-right:silver .5pt solid;border-left:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;" valign="center"><p style="text-align:center;"><span style="font-size:9pt;"><strong><span style="font-family:times new roman;">LabVIEW<br></span><span style="font-family:宋体;">的使用</span></strong></span></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THodpa4TfplmBnVXbfqpUKFj3_JPXBbgVmSZLUCiN5mC7_OXwdYa-fC0bMFtm_0TUZGY?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THoeP_dfNcKseB_kSsDF8sm-yEPOtFHULP3tnGsEioZMrmvC5wbWqmFyhcxT6NKGjAwE?PARTNER=WRITER" border="0"></a></p></td><td style="border-right:silver .5pt solid;border-top-style:none;border-bottom:silver .5pt solid;border-left-style:none;"><p style="text-align:center;"><a href="http://byfiles.storage.msn.com/y1pIcO_924THoelz19hDWGYZzsLSJqNZC4B4gFavAGOxb827uGH31ly9MgaWJkD14MHy5r2lk_Z-s8?PARTNER=WRITER"><img src="http://byfiles.storage.msn.com/y1pIcO_924THocM6QuhNPmbN0uVKlNBBpaXYD72gBTohiIA0-_fIP-peyoEpsXkXLWcmTs9_9V6myg?PARTNER=WRITER" border="0"></a></p></td></tr></tbody></table>

[《我和 LabVIEW》目录](http://ruanqizhen.spaces.live.com/blog/cns!5852D4F797C53FB6!1073.entry)
```