---
title: "制作电子书网站的一点想法"
date: "2021-11-30"
tags: 
  - "码农札记"
---

头一次之作电子书网站，因为没经验，很多问题是做了之后才发现的。等以后有时间了，详细写一写，目前先大致总结一下。

最开始弄的时候，没有借助任何工具，直接就开始搭网页了。当然底层的库用的还是别人写好的，比如最主要的部分，把Markdown格式文档（MD）转换成HTML格式用的是marked.js。上层的代码也并非完全从头开始写， 我也参考了别人的代码。不用工具，自己写的最大好处是让我学习了很多以前不会的技能。以前是没做过网站前端开发的，Javascript也没用过。现在能做个简单网页了。

但是学习过后，发现如果把网页功能完善起来，全自己开发太费时间了。而且继续花时间对我学习的帮助也没有之前那么大了。于是我还是用了工具把网页从新做了一边。最著名的工具大概是 gitbook-cli，一个GitBook发布的旧版本的开源工具。这个工具是在线下把Markdown格式文档转换成HTML格式文档的。更新一个页面的流程大约是这样：找到需要更新的MD文档，修改保存，运行gitbook-cli，生成HTML文档，把生成的HTML文档上传至GitHub。步骤有点繁琐，不是我想要的。而且gitbook-cli有四五年没更新了吧，直接下载后不做点配置都根本运行不起来了。所以放弃了。

后来是用的Docsify重新生成了网站。Docsify还是很简单易用的，不过bug也是很多。有一些bug我直接在本地修改了，但有一些是我没法改的，比如最简单的，它对于HTML tag中图片的路径解析跟别人都不一样，比如：`<img src="images/image192.png">`。它用绝对路径来解析，而其它MD转换工具全部用的相对路径。这个问题我估计Docsify自己也没法改了。不过我现在还有临时解决办法，先将就着用一段时间吧。Docsify生成的网站最大的问题还是没办法被搜索引擎检索，当然也可以说这是搜索引擎不够强大，但是我也没法改变搜索引擎，只能再改进自己的网页了。

Docsify和我最开始写的网页原理完全相同，都是在客户端做渲染，服务器并没有给客户端发送任何HTML格式内容，而现在的搜索引擎只认HTML，它们是不会运行渲染程序的。所以也就没法抓到任何内容。要想被搜索引擎认识，还是得有HTML文件才行。有些网站是可以帮我们做这件事的，比如GitBook。我在GitBook上也生成了一份电子书，[https://labview.qizhen.xyz/](https://labview.qizhen.xyz/) 。在GitBook上做电子书网页，基本没有任何可以配置的东西，所有的网页都长一个模样。这也不是设么大问题，但它无法提供留言功能，还是非常不爽的，我就喜欢看留言。GitBook收费版可能有留言功能，不过穷人并没有尝试付费版。

穷人也不是完全没办法，我们开可以利用GitHub Actions这个免费功能来实现HTML文档的自动生成和部署。GitHub Pages默认就集成了一个Action流程，它可以在每次用户更新 MD 文件之后就调用Jekyll这个工具，为更新的MD文档生成HTML文档在部署到服务器上。只不过GitHub Pages默认的工具对生成的网站有一定格式限制，比较适合做博客，不适合发布书籍。其实可以不用它默认的工具，而是利用GitHub Actions调用一个更适合电子书的转换工具，在MD文件更新后做自动转换和部署。近期我还不会尝试这件事，因为React这个东西我才学了一半，业余时间就那么一点，先抓紧时间学完React再去建新网页。至于转换工具，我会去使用 Docusaurus，因为它使用React写的，正好让我学完了可以实践一下。
