---
title: "使用虚拟仪器搭建射频下变频模块仪器校准系统"
date: "2006-03-17"
tags: 
  - "我和labview"
---

原文在[中国科技论文在线](http://www.paper.edu.cn/)。

下载pdf文档：[http://www.paper.edu.cn/zxlwcomment/comment.jsp?file=200603-90&order=time](http://www.paper.edu.cn/zxlwcomment/comment.jsp?file=200603-90&order=time)

文本：

使用虚拟仪器搭建射频下变频模块仪器校准系统  
阮奇桢  
E-mail：[ruanqizhen@gmail.com](mailto:ruanqizhen@gmail.com)  
摘 要：本文介绍了射频下变频模块仪器的自动化校准技术，以及虚拟仪器技术在校准系统中的应用。文章详细讲解了PXI-5600下变频模块仪器自动校准程序的工作原理以及软硬件系统的搭建方法。  
关键词：LabVIEW，虚拟仪器，校准，下变频模块

Virtual Instrument System for RF Down Converter Modular Instruments  
Qizhen Ruan  
E-mail：[ruanqizhen@gmail.com](mailto:ruanqizhen@gmail.com)  
Abstract  
This article introduces the technology of RF modular instrument automatic calibration system, and how does the virtual instrument concept help in the system. The article also introduces the environment, requirements and process of implementing an RF calibration system.  
Keywords：LabVIEW，Virtual Instrument, Calibration, Down Converter

  
一. 引言  
为了保证测量精度，仪器需要定期做校准。传统仪器可设定的校准参数并不多，通常采用手工校准的方式。随着集成化、模块化仪器的出现和大量使用，这类仪器所需的校准过程变得非常复杂。加之模块化仪器没有直接供用户操作的界面，只能与计算机共同使用，迫使我们不得不采用编程的方法为模块化仪器进行校准。虚拟仪器的概念为搭建校准系统提供了便捷的途径。\[2\]  
射频下变频仪器就是模块化仪器中目前应用前景最为广阔的一种，其代表产品有National Instruments公司的PXI-5600下变频模块。\[3\]  
二. 射频下变频模块仪器的校准原理和校准参数  
1． 射频下变频模块仪器的工作原理  
射频下变频模块仪器通常与数字化模块仪器（或示波器模块）共同时用，以代替传统的频谱仪。  
射频下变频模块用于把输入的射频调制信号的载波频率由射频段降低至中频段，以供数字化模块将调制信号数字化。数字化模块采样率较低，不能用来直接采集频率过高的信号。PXI-5600模块可将载波频率在9k~2.7GHz，带宽在20MHz以内的调制信号变频为载波频率为20MHz、带宽不变的调制信号\[3\]。经过此转换过程，输出信号可被采样率大于50MHz的数字化模块采集，并在计算机内使用软件对采集的数据进行分析、处理、显示，以完成频谱仪甚至部分网络分析仪的功能。  
2． 射频下变频模块仪器的校准原理  
模块化仪器的校准原理与传统仪器略有不同。模块化仪器校准的本质是使用软件来补偿硬件误差。模块化仪器总是与计算机相协同使用的，我们可以在高层应用程序使用模块化仪器的采集数据之前，对模块化仪器测量的原始数据进行补偿，然后将补偿后的数据作为最终测量值传递给上层应用程序，以提高仪器的测量精度。\[2\]  
以温度补偿为例，通常，随着温度的升高，仪器的测量值也随之增加，并且两者具有近似的线性关系。这样我们可以对测量得到的原始值进行修正，以补偿温度变化引起的误差。  
公式为：V=Vo\*(Ca+Cb\*T)  
其中V是最终测量值；Vo是仪器测量的原始值；Ca是温漂误差的常量参数；Cb是温漂误差的一次参数；T为仪器的温度。  
仪器温度校准的过程就是获得以上两个温度补偿参数的过程。  
3． 校准参数  
对于射频下变频模块仪器，除了上面提到的温漂参数，还有其它一些重要参数需要校准。  
内置时钟的频率：下变频一般会有一个频率为10MHz内置时钟。  
射频范围内的功率补偿：对于不同频率的输入信号，下变频模块对信号的衰减是不同的，所以必须用校准参数补偿下变频模块对输入信号衰减。

中频范围内的功率补偿：同样对于不同频率的输出信号，下变频模块也有不同的衰减。该校准参数用于补偿下变频模块对输出信号衰减。  
射频和中频的功率补偿曲线与温度功率补偿曲线不同，它们都是无规则曲线。如使用直线对其拟合，其校准效果十分有限。而使用过高的阶次，会增加运算量，并在拟合曲线边缘产生振荡。根据试验结果，采用7到15阶的曲线对上述参数进行拟合，校准效果最令人满意。  
三. 硬件系统  
1． 结构图  
下变频模块的校准平台由被测量仪器、标准仪器和计算机组成。  
PXI 5600需插入PXI机箱使用，可以通过在PXI机箱上加控制器控制5600模块，也可使用MIX通讯模块将PXI机箱与台式计算机相连，使用计算机控制5600模块。  
铷钟用于为频谱仪提供精准的时钟信号，从而使频谱仪能够准确测量5600发出的信号的频率。  
信号发生器为5600提供RF频段的输入信号。  
功率计的两个通道同时读取5600模块输入端和输出端的信号功率，以比较他们之间的误差。  
信号输出  
信号输入  
信号输入A  
5600 下变频模块  
铷钟  
参考频率输入  
IF信号输出  
参考频率输出  
RF信号输入  
频谱仪  
RF 信号发生器  
功率计  
功率均分器  
信号输入B  
参考时钟输入  
精准10MHz时钟信号输出  
PXI 机箱  
与计算机相连  
图1： 硬件系统结构  
2． 选择标准仪器  
标准仪器的选择有以下两点原则：一是标准仪器的测量范围和精度要满足校准要求，二是尽量采用常用的仪器。  
5600模块内置时钟校准后的频率要求是10MHz，误差在0.1Hz内。标准仪器的精度应比这高一个数量级，即1 ppb。一般的晶振时钟很难达到此精度，因此我们选择铷钟作为时钟基准。常见的铷钟型号有Datum 8040等。  
因为频谱仪由外接铷钟提供基准频率，因此我们可以不用担心频谱仪的频率精度。一般频谱仪的分辨率通常大于0.1Hz，我们可以采用测量5600模块内置时钟信号的第11阶谐波的方法来提高分辨率：10MHz的信号的第11阶谐波频率为110MHz，其误差应在1Hz以内。因此，只要测量范围包括110MHz，分辨率在1Hz以内的频谱仪都可用于5600的校准。目前最常见的频谱仪是Agilent公司的AGESA系列频谱仪。  
RF信号发生器需要提供频率高达3GHz的信号，可以选用Agilent公司AGESG系列信号发生器中频率范围超过3GHz的型号。  
常见的功率计有Agilent公司的AGESP系列，和Rohde & Schwarz公司的NRVD系列。需要注意的是，功率计还需要选择适合的传感器探头。由于在校准过程中，功率计的两个通  
  

[](http://www.paper.edu.cn/)  
道分别测量RF段和IF段的信号，因此，我们所选用的传感器探头的测量频率范围应分别为20MHz~2.8GHz和3MHz~27MHz。  
四. 软件系统  
仪器的校准软件往往要提供给不同的校准实验室使用，而每个实验室所拥有的标准仪器都不尽相同，这就要求编写的校准程序必须具有仪器可互换性。IVI（可互换虚拟仪器）架构为我们的校准系统实现仪器可互换提供了保证。\[5\]  
校准程序的总体框架如图2所示。  
最顶层的主程序通过调度仪器控制模块控制仪器，读取测量数据并对数据进行分析处理，得出校准数据并以此校准RF模块仪器。主程序同时也负责提供用户交户界面。  
IVI架构的核心部分是对于标准仪器进行控制的部分。为了实现仪器的可互换性，校准主程序不是直接调用每个仪器的驱动程序，而是调用IVI的类驱动程序。在使用IVI类驱动程序时，用户还需要在IVI配置工具（例如：NI MAX）中指定所使用的具体仪器的型号\[5\]。IVI类驱动程序根据用户的配置再调用具体的仪器驱动程序。当用户换用其他型号的标准仪器时，已经编写好的校准程序本身不需要做任何改动，只需在IVI配置工具中选择新仪器的型号即可令校准程序具有新仪器的校准功能。  
通常，仪器厂商会提供用于控制被校准模块仪器的仪器驱动和校准的软件接口。例如，我们所使用的PXI-5600的驱动和校准接口是由NI RFSA中提供的。\[4\]  
编程所使用的语言为LabVIEW\[1\]。在校准过程中所需的标准仪器和被校准仪器都具有LabVIEW版本的驱动程序。并且LabVIEW的图形化编程特性可以大大缩短校准软件的开发时间。在项目前期调研过程中，经测试，使用LabVIEW作为本项目的开发语言开发时间仅为使用VC++或VB开发时间的20%。  
校准程序主程序  
RF模块仪器校准驱动  
IVI类驱动程序  
功率计、频谱仪、RF信号发生器  
仪器驱动程序  
功率计、频谱仪、RF信号发生器  
RF模块仪器  
标准仪器  
功率计、频谱仪、RF信号发生器  
图2： 软件系统结构

[](http://www.paper.edu.cn/)

  
图3： 校准PXI-5600内部时钟的LabVIEW程序

###   
参考文献：

    \[1\] National Instruments，LabVIEW Advanced Course \[M\]. US. 2003. 
    \[2\] National Instruments，Calibration Executive Manual \[M\]. US. 2005. 
    \[3\] National Instruments，NI PXI-5600 Specification \[M\]. US. 2005. 
    \[4\] National Instruments，NI RFSA Manual \[M\]. US. 2005. 
    \[5\] IVI Foundation，IVI Specifications \[M\]. US. 2002. 
    \[6\] [可互换虚拟仪器驱动程序的开发](http://ruanqizhen.spaces.msn.com/blog/cns!5852D4F797C53FB6!1060.entry)，阮奇桢. 2006. 
    \[7\] [其它相关技术文章](http://spaces.msn.com/ruanqizhen/blog/cns!5852D4F797C53FB6!1073.entry)  

